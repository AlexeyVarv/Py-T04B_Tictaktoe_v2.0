# Project Backend 04 — Python_Bootcamp  

Резюме: в этом проекте ты научишься добавлять базы данных в веб-приложения на языке **Python** с использованием **Flask** и работать с авторизацией.
         

## Chapter I
### Проект: Крестики-Нолики
## Задание 0. Создание проекта
Для разработки на языке Python тебе нужно будет установить соответствующий интерпретатор.
Его можно скачать с официального сайта. После ты сможешь использовать командную строку
и/или различные интегрированные среды разработки (IDE) для работы над проектами.

Проект в данном случае — набор файлов с расширением .py, которые содержат код на языке Python,
запускаются командой python filename.py (или python3) по отдельности либо импортируются в какой-то общий файл, который часто называют main.py.

В PyCharm процесс создания проекта достаточно прост: нужно лишь выбрать интерпретатор Python,
который будет использоваться, а также путь для сохранения и название проекта. Возможно также создание виртуального окружения, которое обычно удобно использовать для больших проектов с множеством различных зависимостей (библиотек, фреймворков).

## Задание 1. Создание структуры проекта
- Каждый слой является отдельным модулем.
- Структура проекта должна иметь следующие слои: web, domain, datasource, di.
- Слой web должен включать в себя как минимум пакеты model, module, route, mapper для взаимодействия с клиентом.
- Слой domain должен включать в себя как минимум пакеты model, service для реализации бизнес-логики приложения.
- Слой datasource должен включать в себя как минимум пакеты model, repository, mapper для реализации работы с данными (например, с базой данных).
- В слое di описываются конфигурации для внедрения зависимостей.

## Задание 2. Реализация domain-слоя
- Опиши модель игрового поля в виде целочисленной матрицы.
- Опиши модель текущей игры, у которой есть UUID и игровое поле.
- Опиши интерфейс сервиса, у которого есть следующие методы:
    - метод получения следующего хода текущей игры алгоритмом Минимакс;
    - метод валидации игрового поля текущей игры (проверь, что не изменены предыдущие ходы);
    - метод проверки окончания игры.
- Модели, интерфейсы, реализации должны находиться в разных файлах.

## Задание 3. Реализация datasource-слоя
- Реализуй класс-хранилище для хранения текущих игр.
- В качестве средства хранения используй потокобезопасные коллекции.
- Опиши модели игрового поля, текущей игры.
- Реализуй мапперы domain<->datasource.
- Реализуй репозиторий для работы с классом-хранилищем, у которого есть следующие методы:
    - метод сохранения текущей игры;
    - метод получения текущей игры.
- Создай класс, реализующий интерфейс сервиса и принимающий в качестве параметра репозиторий для работы с классом-хранилищем.
- Модели, интерфейсы, реализации должны находиться в разных файлах.

## Задание 4. Реализация web-слоя
- Опиши модели игрового поля, текущей игры.
- Реализуй мапперы domain<->web.
- Реализуй контроллер с использованием Flask, имеющий метод POST /game/{UUID текущей игры}, который отправляет текущую игру с обновленным игровым полем пользователем и получает в ответ текущую игру с обновленным игровым полем компьютером.
- Если отправлена некорректная текущая игра с обновленным полем, должна вернуться ошибка с описанием.
- Должна быть поддержка нескольких игр одновременно.
- Модели, интерфейсы, реализации должны находиться в разных файлах.

## Задание 5. Реализация di-слоя
- Реализуй класс Container, в котором описывается граф зависимостей.
- Он должен содержать как минимум: 
   - класс-хранилище в качестве singleton;
   - репозиторий для работы с классом-хранилищем;
   - сервис для работы с репозиторием.

## Chapter II
### Проект: Крестики-Нолики
Используй проект для серверной части из Главы 1.

## Задание 1. Добавление базы данных
- Опиши подключение к базе данных PostgreSQL с расширением SQLALchemy.
- Избавься от класса-хранилища.
- Добавь специальные аннотации для параметров классов, которые необходимо сохранять в базу данных.

## Задание 2. Добавление авторизации
- Добавь пользователей, у которых будет UUID, логин, пароль.
- Реализуй поддержку пользователей на всех слоях.
- Создай модель SignUpRequest, у которой будет логин и пароль.
- Создай сервис авторизации, который использует UserService:
    - метод регистрации, который принимает SignUpRequest и возвращает факт успешной регистрации;
    - метод авторизации, который принимает в заголовке логин и пароль в виде base64(login:password) и возвращает UUID пользователя.
- Создай контроллер авторизации, у которого будут следующие endpoint'ы:
    - для регистрации пользователя,
    - для авторизации пользователя.
- Создай структуру UserAuthenticator с защитой от создания запросов неавторизированными пользователями:
    - Провалидируй логин и пароль.
    - Если валидация прошла успешно, то выполни запрос.
    - Если валидация прошла с ошибкой, то добавь в ответ 401 код и не выполняй запрос. 
- Добавь UserAuthenticator для своих запросов:
    - Разреши доступ без авторизации к endpoint'ам регистрации и авторизации.
    - Для всех остальных endpoint'ов должна требоваться авторизация.

## Задание 3. Добавление логики игры между двумя игроками
- Добавь состояния для текущей игры:
    - Ожидание игроков;
    - Ход игрока с UUID;
    - Ничья;
    - Победа игрока с UUID.
- Добавь в текущую игру информацию о значках, которыми будут ходить пользователи.
- Улучши алгоритм определения окончания игры с использованием состояний.
- Добавь endpoint для создания новой игры с пользователем или компьютером.
- Добавь endpoint для получения доступных текущих игр.
- Добавь endpoint для присоединения пользователя к игре.
- Улучши endpoint обновления текущей игры с учетом игры с пользователем или компьютером.
- Добавь endpoint для получения текущей игры.
- Добавь endpoint для получения информации о пользователе по UUID.